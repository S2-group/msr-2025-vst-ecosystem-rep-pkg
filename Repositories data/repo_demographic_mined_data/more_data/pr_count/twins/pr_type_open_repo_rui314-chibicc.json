{"total_count": 28, "incomplete_results": false, "items": [{"url": "https://api.github.com/repos/rui314/chibicc/issues/154", "repository_url": "https://api.github.com/repos/rui314/chibicc", "labels_url": "https://api.github.com/repos/rui314/chibicc/issues/154/labels{/name}", "comments_url": "https://api.github.com/repos/rui314/chibicc/issues/154/comments", "events_url": "https://api.github.com/repos/rui314/chibicc/issues/154/events", "html_url": "https://github.com/rui314/chibicc/pull/154", "id": 2804161014, "node_id": "PR_kwDOC_Cqos6Incbj", "number": 154, "title": "Allocate new buckets and reuse the existing HashMap structure", "user": {"login": "s311354", "id": 26519320, "node_id": "MDQ6VXNlcjI2NTE5MzIw", "avatar_url": "https://avatars.githubusercontent.com/u/26519320?v=4", "gravatar_id": "", "url": "https://api.github.com/users/s311354", "html_url": "https://github.com/s311354", "followers_url": "https://api.github.com/users/s311354/followers", "following_url": "https://api.github.com/users/s311354/following{/other_user}", "gists_url": "https://api.github.com/users/s311354/gists{/gist_id}", "starred_url": "https://api.github.com/users/s311354/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/s311354/subscriptions", "organizations_url": "https://api.github.com/users/s311354/orgs", "repos_url": "https://api.github.com/users/s311354/repos", "events_url": "https://api.github.com/users/s311354/events{/privacy}", "received_events_url": "https://api.github.com/users/s311354/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 0, "created_at": "2025-01-22T11:41:22Z", "updated_at": "2025-01-22T11:41:22Z", "closed_at": null, "author_association": "NONE", "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/rui314/chibicc/pulls/154", "html_url": "https://github.com/rui314/chibicc/pull/154", "diff_url": "https://github.com/rui314/chibicc/pull/154.diff", "patch_url": "https://github.com/rui314/chibicc/pull/154.patch", "merged_at": null}, "body": "## Problem: \r\nThe current implementation of get_or_insert_entry ,and hashmap_put2 functions are called frequently but without significant overhead. Additionally, these also are critical for managing hashmaps.\r\n\r\nHowever, these two functions form a cycle, indicating recursive or interdependent calls. These cycles might lead to potential inefficiencies.\r\n\u2028\r\n#### Flat profile from the original code:\r\n```  \r\n%   cumulative   self              self     total           \r\n time   seconds   seconds    calls  Ts/call  Ts/call  name    \r\n  0.00      0.00     0.00      205     0.00     0.00  match\r\n  0.00      0.00     0.00      142     0.00     0.00  startswith\r\n  0.00      0.00     0.00      127     0.00     0.00  fnv_hash\r\n  0.00      0.00     0.00      127     0.00     0.00  get_or_insert_entry\r\n  0.00      0.00     0.00      127     0.00     0.00  hashmap_put2\r\n  0.00      0.00     0.00       84     0.00     0.00  new_token\r\n  0.00      0.00     0.00       67     0.00     0.00  in_range\r\n  0.00      0.00     0.00       59     0.00     0.00  decode_utf8\r\n  0.00      0.00     0.00       59     0.00     0.00  is_valid_identifier_char\r\n  0.00      0.00     0.00       47     0.00     0.00  add_macro\r\n  0.00      0.00     0.00       47     0.00     0.00  hashmap_put\r\n  0.00      0.00     0.00       42     0.00     0.00  add_line_numbers\r\n  0.00      0.00     0.00       42     0.00     0.00  define_macro\r\n  0.00      0.00     0.00       42     0.00     0.00  new_file\r\n  0.00      0.00     0.00       42     0.00     0.00  tokenize\r\n  0.00      0.00     0.00       32     0.00     0.00  strarray_push\r\n```\r\n\r\n## Proposal: Reduced Recursive Dependencies\r\n\r\n#### Flat profile from the proposed code:\r\n```\r\n  %   cumulative   self              self     total           \r\n time   seconds   seconds    calls  Ts/call  Ts/call  name    \r\n  0.00      0.00     0.00      142     0.00     0.00  startswith\r\n  0.00      0.00     0.00      127     0.00     0.00  fnv_hash\r\n  0.00      0.00     0.00      108     0.00     0.00  match\r\n  0.00      0.00     0.00       84     0.00     0.00  new_token\r\n  0.00      0.00     0.00       67     0.00     0.00  in_range\r\n  0.00      0.00     0.00       59     0.00     0.00  decode_utf8\r\n  0.00      0.00     0.00       59     0.00     0.00  is_valid_identifier_char\r\n  0.00      0.00     0.00       47     0.00     0.00  add_macro\r\n  0.00      0.00     0.00       47     0.00     0.00  get_or_insert_entry\r\n  0.00      0.00     0.00       47     0.00     0.00  hashmap_put\r\n  0.00      0.00     0.00       47     0.00     0.00  hashmap_put2\r\n  0.00      0.00     0.00       42     0.00     0.00  add_line_numbers\r\n  0.00      0.00     0.00       42     0.00     0.00  define_macro\r\n  0.00      0.00     0.00       42     0.00     0.00  new_file\r\n  0.00      0.00     0.00       42     0.00     0.00  tokenize\r\n  0.00      0.00     0.00       32     0.00     0.00  strarray_push\r\n```\r\n\r\nObserved Behavior:\r\n\t\u2022\thashmap_put2 has fewer calls, indicating better interdependency management.\r\n\t\u2022\tmatch has reduced calls, showing fewer redundant comparisons.\r\n", "reactions": {"url": "https://api.github.com/repos/rui314/chibicc/issues/154/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rui314/chibicc/issues/154/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}]}