{"total_count": 4, "incomplete_results": false, "items": [{"url": "https://api.github.com/repos/ninjaprawn/async_wake-fun/issues/13", "repository_url": "https://api.github.com/repos/ninjaprawn/async_wake-fun", "labels_url": "https://api.github.com/repos/ninjaprawn/async_wake-fun/issues/13/labels{/name}", "comments_url": "https://api.github.com/repos/ninjaprawn/async_wake-fun/issues/13/comments", "events_url": "https://api.github.com/repos/ninjaprawn/async_wake-fun/issues/13/events", "html_url": "https://github.com/ninjaprawn/async_wake-fun/pull/13", "id": 283642986, "node_id": "MDExOlB1bGxSZXF1ZXN0MTU5NDc3OTI1", "number": 13, "title": "New inject_trusts", "user": {"login": "hieplpvip", "id": 17219541, "node_id": "MDQ6VXNlcjE3MjE5NTQx", "avatar_url": "https://avatars.githubusercontent.com/u/17219541?v=4", "gravatar_id": "", "url": "https://api.github.com/users/hieplpvip", "html_url": "https://github.com/hieplpvip", "followers_url": "https://api.github.com/users/hieplpvip/followers", "following_url": "https://api.github.com/users/hieplpvip/following{/other_user}", "gists_url": "https://api.github.com/users/hieplpvip/gists{/gist_id}", "starred_url": "https://api.github.com/users/hieplpvip/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/hieplpvip/subscriptions", "organizations_url": "https://api.github.com/users/hieplpvip/orgs", "repos_url": "https://api.github.com/users/hieplpvip/repos", "events_url": "https://api.github.com/users/hieplpvip/events{/privacy}", "received_events_url": "https://api.github.com/users/hieplpvip/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 6, "created_at": "2017-12-20T17:42:27Z", "updated_at": "2017-12-21T00:53:20Z", "closed_at": "2017-12-20T22:45:56Z", "author_association": "NONE", "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/ninjaprawn/async_wake-fun/pulls/13", "html_url": "https://github.com/ninjaprawn/async_wake-fun/pull/13", "diff_url": "https://github.com/ninjaprawn/async_wake-fun/pull/13.diff", "patch_url": "https://github.com/ninjaprawn/async_wake-fun/pull/13.patch", "merged_at": null}, "body": "void inject_trusts(int pathc, char *paths[]) {\r\n    uint64_t tc = find_trustcache();\r\n    \r\n    struct trust_chain {\r\n        uint64_t next;\r\n        unsigned char uuid[16];\r\n        unsigned int count;\r\n    } __attribute__((packed));\r\n    \r\n    struct trust_chain fake_chain;\r\n    fake_chain.next = kread64(tc);\r\n    *(uint64_t *)&fake_chain.uuid[0] = 0xabadbabeabadbabe;\r\n    *(uint64_t *)&fake_chain.uuid[8] = 0xabadbabeabadbabe;\r\n    fake_chain.count = pathc;\r\n    \r\n    uint8_t *allhash = malloc(20*pathc);\r\n    for (int i = 0; i != pathc; ++i) {\r\n        printf(\"[+] calculating hash '%s'\\n\", paths[i]);\r\n        uint8_t *hash = get_sha256(get_code_directory(paths[i]));\r\n        memmove(allhash + 20*i, hash, 20);\r\n        free(hash);\r\n    }\r\n    \r\n    size_t length = (sizeof(fake_chain) + pathc * 20 + 0xFFFF) & ~0xFFFF;\r\n    uint64_t kernel_trust = kalloc(length);\r\n    \r\n    kwrite(kernel_trust, &fake_chain, sizeof(fake_chain));\r\n    kwrite(kernel_trust + sizeof(fake_chain), allhash, pathc * 20);\r\n    kwrite64(tc, kernel_trust);\r\n        printf(\"[+] injected trust cache\\n\");\r\n    return;\r\n}", "reactions": {"url": "https://api.github.com/repos/ninjaprawn/async_wake-fun/issues/13/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/ninjaprawn/async_wake-fun/issues/13/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}]}