{"total_count": 11, "incomplete_results": false, "items": [{"url": "https://api.github.com/repos/rfennell/AzurePipelines/issues/1551", "repository_url": "https://api.github.com/repos/rfennell/AzurePipelines", "labels_url": "https://api.github.com/repos/rfennell/AzurePipelines/issues/1551/labels{/name}", "comments_url": "https://api.github.com/repos/rfennell/AzurePipelines/issues/1551/comments", "events_url": "https://api.github.com/repos/rfennell/AzurePipelines/issues/1551/events", "html_url": "https://github.com/rfennell/AzurePipelines/issues/1551", "id": 1891355739, "node_id": "I_kwDOAoLSoM5wu8xb", "number": 1551, "title": "Unable to get details on PR related work items", "user": {"login": "Japeth", "id": 13561320, "node_id": "MDQ6VXNlcjEzNTYxMzIw", "avatar_url": "https://avatars.githubusercontent.com/u/13561320?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Japeth", "html_url": "https://github.com/Japeth", "followers_url": "https://api.github.com/users/Japeth/followers", "following_url": "https://api.github.com/users/Japeth/following{/other_user}", "gists_url": "https://api.github.com/users/Japeth/gists{/gist_id}", "starred_url": "https://api.github.com/users/Japeth/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Japeth/subscriptions", "organizations_url": "https://api.github.com/users/Japeth/orgs", "repos_url": "https://api.github.com/users/Japeth/repos", "events_url": "https://api.github.com/users/Japeth/events{/privacy}", "received_events_url": "https://api.github.com/users/Japeth/received_events", "type": "User", "site_admin": false}, "labels": [{"id": 257878262, "node_id": "MDU6TGFiZWwyNTc4NzgyNjI=", "url": "https://api.github.com/repos/rfennell/AzurePipelines/labels/bug", "name": "bug", "color": "fc2929", "default": true, "description": null}, {"id": 582582727, "node_id": "MDU6TGFiZWw1ODI1ODI3Mjc=", "url": "https://api.github.com/repos/rfennell/AzurePipelines/labels/GenerateReleaseNotes%20(XPlat%20version)", "name": "GenerateReleaseNotes (XPlat version)", "color": "d4c5f9", "default": false, "description": null}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 2, "created_at": "2023-09-11T22:16:35Z", "updated_at": "2023-09-18T08:11:53Z", "closed_at": null, "author_association": "NONE", "active_lock_reason": null, "body": "### Azure DevOps Extensions\n\nGenerate Release Notes (Node Cross Platform)\n\n### Platform\n\nAzure DevOps Services\n\n### Azure DevOps Server (TFS) Version\n\n_No response_\n\n### Extension Version\n\n_No response_\n\n### Describe the bug\n\nIt looks like the function \"lookup_a_work_item\" may have some issues, or something else is going on.\r\n\r\nI've nearly cut-and-pasted the example for querying the associated PRs and Work Items for a build, but the work items for each PR do not show up.  However, the query does know that there ARE work items, and how many, and what the links to them are.  Which lead me down the path to believing it is the \"lookup_a_work_item\" function that is not doing what it needs to.\r\n\r\nHere is my markdown:\r\n\r\n\r\n      ## Build {{buildDetails.buildNumber}}\r\n      * **Branch**: {{buildDetails.sourceBranch}}\r\n      * **Tags**: {{buildDetails.tags}}\r\n      * **Completed**: {{buildDetails.finishTime}}\r\n      * **Previous Build**: {{compareBuildDetails.buildNumber}}\r\n\r\n      ## Strategy\r\n      - **Communication Plan** - Email notifications are sent during each event of the pipeline either requesting approval to deploy or providing management with status updates.\r\n      - **Risk Analysis** - The pipeline performs minimal automated smoke testing of the internet endpoints.  The team will perform manual validation, including validation of Akamai and Azure endpoints.\r\n      - **Implementation Plan** - Feature changes are developed in story branches based off of main.  The story branch is built and tested against non-prod environments.  A PR is open to merge the changes into the main branch.  A release branch is then cut from the main branch and deployed to the Pre-Prod environment for further testing.  Once all controls have been met the release branch is then deployed to the Production environment.\r\n      - **Backout Plan** - Redeploy previous Release branch.\r\n      - **Pre-install Test Plan** - The pipeline executes unit tests and smoke tests.  If any of these stages fail then the pipeline cannot proceed further and exits out.\r\n      - **Post-install Test Plan** - The pipeline performs minimal automated smoke testing of the internet endpoints.  The team will perform manual validation, including validation of Akamai and Azure endpoints.\r\n\r\n      ## Associated Pull Requests ({{pullRequests.length}})\r\n      {{#forEach pullRequests}}\r\n      ### **[{{this.pullRequestId}}]({{replace (replace this.url \"_apis/git/repositories\" \"_git\") \"pullRequests\" \"pullRequest\"}})** {{this.title}}\r\n      * Associated Work Items ({{this.associatedWorkitems.length}})\r\n      {{#forEach this.associatedWorkitems}}\r\n        {{#with (lookup_a_work_item ../../relatedWorkItems this.url)}}\r\n          - [{{this.id}}]({{replace this.url \"_apis/wit/workItems\" \"_workitems/edit\"}}) - {{lookup this.fields 'System.Title'}}\r\n        {{/with}}\r\n      {{/forEach}}\r\n      * Associated Commits (this includes commits on the PR source branch not associated directly with the build)\r\n      {{#forEach this.associatedCommits}}\r\n          - [{{this.commitId}}]({{replace this.remoteUrl \" \" \"%20\"}}) -  {{this.comment}}\r\n      {{/forEach}}\r\n      {{/forEach}}\r\n\r\nAnd the markdown release notes that are generated:\r\n\r\n# Notes for build\r\n\r\n## Build [adt001] Digital NonProd Env Build.254.2\r\n* **Branch**: refs/heads/story/release-notes-comparison\r\n* **Tags**: \r\n* **Completed**: \r\n* **Previous Build**: [npd000] Digital NonProd Env Build.250.2\r\n\r\n## Strategy\r\n- **Communication Plan** - Email notifications are sent during each event of the pipeline either requesting approval to deploy or providing management with status updates.\r\n- **Risk Analysis** - The pipeline performs minimal automated smoke testing of the internet endpoints.  The team will perform manual validation, including validation of Akamai and Azure endpoints.\r\n- **Implementation Plan** - Feature changes are developed in story branches based off of main.  The story branch is built and tested against non-prod environments.  A PR is open to merge the changes into the main branch.  A release branch is then cut from the main branch and deployed to the Pre-Prod environment for further testing.  Once all controls have been met the release branch is then deployed to the Production environment.\r\n- **Backout Plan** - Redeploy previous Release branch.\r\n- **Pre-install Test Plan** - The pipeline executes unit tests and smoke tests.  If any of these stages fail then the pipeline cannot proceed further and exits out.\r\n- **Post-install Test Plan** - The pipeline performs minimal automated smoke testing of the internet endpoints.  The team will perform manual validation, including validation of Akamai and Azure endpoints.\r\n\r\n## Associated Pull Requests (3)\r\n### **[2577](https://dev.azure.com/removed/b5cf4ec3-b4b5-4309-8c4c-d6628fcae0d8/_git/5c5dde05-800d-421c-9d9c-53ab671321e4/pullRequest/2577)** Enable suffix to fix destroy pipeline issue\r\n* Associated Work Items (1)\r\n* Associated Commits (this includes commits on the PR source branch not associated directly with the build)\r\n    - [5d1427389986a95b0371d3f474592700196375d1](https://dev.azure.com/removed/DigAPB/_git/MC%20Connected%20Baseline/commit/5d1427389986a95b0371d3f474592700196375d1) -  Merge branch &#x27;main&#x27; into story/30809_destroy_suffix\r\n    - [cc8223fb515c090e29b0bfbb6fb3236c8a1437eb](https://dev.azure.com/removed/DigAPB/_git/MC%20Connected%20Baseline/commit/cc8223fb515c090e29b0bfbb6fb3236c8a1437eb) -  Enable suffix to fix destroy pipeline issue\r\n    - [3a872cc7a6f560b30f0596017d4d3f9619411ff4](https://dev.azure.com/removed/DigAPB/_git/MC%20Connected%20Baseline/commit/3a872cc7a6f560b30f0596017d4d3f9619411ff4) -  Adding adt008 configs\r\n### **[2573](https://dev.azure.com/removed/b5cf4ec3-b4b5-4309-8c4c-d6628fcae0d8/_git/5c5dde05-800d-421c-9d9c-53ab671321e4/pullRequest/2573)** Adding adt008 configs\r\n* Associated Work Items (1)\r\n* Associated Commits (this includes commits on the PR source branch not associated directly with the build)\r\n    - [3a872cc7a6f560b30f0596017d4d3f9619411ff4](https://dev.azure.com/removed/DigAPB/_git/MC%20Connected%20Baseline/commit/3a872cc7a6f560b30f0596017d4d3f9619411ff4) -  Adding adt008 configs\r\n### **[2553](https://dev.azure.com/removed/b5cf4ec3-b4b5-4309-8c4c-d6628fcae0d8/_git/5c5dde05-800d-421c-9d9c-53ab671321e4/pullRequest/2553)** Destroy Pipeline Fix\r\n* Associated Work Items (1)\r\n* Associated Commits (this includes commits on the PR source branch not associated directly with the build)\r\n    - [7e286375312f3c4fd4cfc64f1fc1aed4cee302f1](https://dev.azure.com/removed/DigAPB/_git/MC%20Connected%20Baseline/commit/7e286375312f3c4fd4cfc64f1fc1aed4cee302f1) -  Updated steps-terraform-show.yaml\r\n    - [e53dc8ab2cc1e3ac2e377ddf5423ec1882be4241](https://dev.azure.com/CostcoWholesale/DigAPB/_git/MC%20Connected%20Baseline/commit/e53dc8ab2cc1e3ac2e377ddf5423ec1882be4241) -  Updated steps-terraform-show.yaml\r\n\n\n### Repo Steps\n\n- Use markdown as above.\r\n- Generate release notes\r\n- View!\n\n### Expected Behavior\n\nThat the related work items are able to be populated.\n\n### Logging Information\n\n_No response_", "reactions": {"url": "https://api.github.com/repos/rfennell/AzurePipelines/issues/1551/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/rfennell/AzurePipelines/issues/1551/timeline", "performed_via_github_app": null, "state_reason": null, "score": 1.0}]}