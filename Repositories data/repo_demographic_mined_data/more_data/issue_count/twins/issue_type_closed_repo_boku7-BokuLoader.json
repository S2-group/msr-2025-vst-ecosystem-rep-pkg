{"total_count": 11, "incomplete_results": false, "items": [{"url": "https://api.github.com/repos/boku7/BokuLoader/issues/35", "repository_url": "https://api.github.com/repos/boku7/BokuLoader", "labels_url": "https://api.github.com/repos/boku7/BokuLoader/issues/35/labels{/name}", "comments_url": "https://api.github.com/repos/boku7/BokuLoader/issues/35/comments", "events_url": "https://api.github.com/repos/boku7/BokuLoader/issues/35/events", "html_url": "https://github.com/boku7/BokuLoader/issues/35", "id": 2104351592, "node_id": "I_kwDOF6FO7859bdto", "number": 35, "title": "executable error 0xc00000005", "user": {"login": "chenser9", "id": 44432772, "node_id": "MDQ6VXNlcjQ0NDMyNzcy", "avatar_url": "https://avatars.githubusercontent.com/u/44432772?v=4", "gravatar_id": "", "url": "https://api.github.com/users/chenser9", "html_url": "https://github.com/chenser9", "followers_url": "https://api.github.com/users/chenser9/followers", "following_url": "https://api.github.com/users/chenser9/following{/other_user}", "gists_url": "https://api.github.com/users/chenser9/gists{/gist_id}", "starred_url": "https://api.github.com/users/chenser9/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/chenser9/subscriptions", "organizations_url": "https://api.github.com/users/chenser9/orgs", "repos_url": "https://api.github.com/users/chenser9/repos", "events_url": "https://api.github.com/users/chenser9/events{/privacy}", "received_events_url": "https://api.github.com/users/chenser9/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [], "state": "closed", "locked": true, "assignee": null, "assignees": [], "milestone": null, "comments": 3, "created_at": "2024-01-28T21:17:46Z", "updated_at": "2024-02-04T23:12:07Z", "closed_at": "2024-02-04T23:12:07Z", "author_association": "NONE", "sub_issues_summary": {"total": 0, "completed": 0, "percent_completed": 0}, "active_lock_reason": null, "body": "Hi! I am running bokuloader on CS4.8 using [jquery-c2.4.7.profile](https://raw.githubusercontent.com/threatexpress/malleable-c2/master/jquery-c2.4.7.profile). When I runned my stageless beacon file \"beacon_x64.exe\" on the latest windows 10 machine, a memory access violation error occured and I didn't know why it happened. I have check my `BEACON_RDLL_SIZE` value which is set to 100, and below is some output from the script console:\r\n```\r\n[20:54:30] [*] Generating Payload: https -- Arch: x64 -- Exit Function: Process -- System Call: None\r\n[20:54:30] [!] ========== Running 'BEACON_RDLL_SIZE' for DLL Name resources/beacon.x64.dll with architecture x64 at BokuLoader.cna:1102\r\n[20:54:30] [*] BEACON_RDLL_SIZE hook returned size: 100\r\n[20:54:31] [!] ========== Running 'BEACON_RDLL_GENERATE' for DLL resources/beacon.x64.rl100k.dll with architecture x64 ========== at BokuLoader.cna:1092\r\n[20:54:31] [!] loading: BokuLoader.x64.o at BokuLoader.cna:930\r\n[20:54:31] [!] Loaded Length: 21011 at BokuLoader.cna:936\r\n[20:54:31] [!] Extracted Length: 15040 at BokuLoader.cna:944\r\n[20:54:31] [*] setup_reflective_loader - Available space for the reflective loader: 100K\r\n[20:54:31] [*] setup_reflective_loader - located ReflectiveLoader function at offset 116620\r\n[+] Beacon DLL size: 0x67A00\r\n[+] Malleable PE options defined in Malleable C2 profile:\r\n|__ Obfuscate        : true\r\n|__ sleep_mask       : true\r\n|__ userwx           : false\r\n|__ stomppe          : true\r\n|__ allocator        : VirtualAlloc\r\n|__ magic_mz         : MZAR\r\n|__ magic_pe         : NO\r\n|__ image_size_x64   : 4661248\r\n|__ module_x64       : \r\n|__ entry_point      : 650688\r\n|__ rich_header      : >\u0098\u00feuz\u00f9\u0090&z\u00f9\u0090&z\u00f9\u0090&s\u0081&\u00fc\u00f9\u0090&\u0017\u00a4\u0093'y\u00f9\u0090&z\u00f9\u0091&\u0083\u00fd\u0090&\u0017\u00a4\u0091'e\u00f9\u0090&\u0017\u00a4\u0095'w\u00f9\u0090&\u0017\u00a4\u0094'l\u00f9\u0090&\u0017\u00a4\u009e'V\u00f8\u0090&\u0017\u00a4o&{\u00f9\u0090&\u0017\u00a4\u0092'{\u00f9\u0090&Richz\u00f9\u0090&\r\n```\r\nAnd I also attached some information from windbg when running the beacon exe file, hopefully you could help me find out what is going on:\r\n```\r\n(1848.1838): Access violation - code c0000005 (first chance)\r\nFirst chance exceptions are reported before any exception handling.\r\nThis exception may be expected and handled.\r\nntdll!LdrpAllocateTlsEntry+0xc8:\r\n00007ff9`f59f8474 8911            mov     dword ptr [rcx],edx ds:b3c147db`085240aa=????????\r\n0:000> !analyze -v\r\n*******************************************************************************\r\n*                                                                             *\r\n*                        Exception Analysis                                   *\r\n*                                                                             *\r\n*******************************************************************************\r\n\r\n*** WARNING: Check Image - Checksum mismatch - Dump: 0x1f1c9f, File: 0x1f7462 - C:\\ProgramData\\Dbg\\sym\\ntdll.dll\\9B64AA6F1f8000\\ntdll.dll\r\n\r\nKEY_VALUES_STRING: 1\r\n\r\n    Key  : AV.Fault\r\n    Value: Read\r\n\r\n    Key  : Analysis.CPU.mSec\r\n    Value: 202\r\n\r\n    Key  : Analysis.Elapsed.mSec\r\n    Value: 295\r\n\r\n    Key  : Analysis.IO.Other.Mb\r\n    Value: 0\r\n\r\n    Key  : Analysis.IO.Read.Mb\r\n    Value: 0\r\n\r\n    Key  : Analysis.IO.Write.Mb\r\n    Value: 0\r\n\r\n    Key  : Analysis.Init.CPU.mSec\r\n    Value: 139\r\n\r\n    Key  : Analysis.Init.Elapsed.mSec\r\n    Value: 18291\r\n\r\n    Key  : Analysis.Memory.CommitPeak.Mb\r\n    Value: 45\r\n\r\n    Key  : Failure.Bucket\r\n    Value: INVALID_POINTER_READ_c0000005_ntdll.dll!LdrpAllocateTlsEntry\r\n\r\n    Key  : Failure.Hash\r\n    Value: {fde563d4-5794-c66a-9cd3-1abf820d3d24}\r\n\r\n    Key  : Timeline.OS.Boot.DeltaSec\r\n    Value: 222\r\n\r\n    Key  : Timeline.Process.Start.DeltaSec\r\n    Value: 18\r\n\r\n    Key  : WER.OS.Branch\r\n    Value: vb_release\r\n\r\n    Key  : WER.OS.Version\r\n    Value: 10.0.19041.1\r\n\r\n\r\nNTGLOBALFLAG:  70\r\n\r\nPROCESS_BAM_CURRENT_THROTTLED: 0\r\n\r\nPROCESS_BAM_PREVIOUS_THROTTLED: 0\r\n\r\nAPPLICATION_VERIFIER_FLAGS:  0\r\n\r\nEXCEPTION_RECORD:  (.exr -1)\r\nExceptionAddress: 00007ff9f59f8474 (ntdll!LdrpAllocateTlsEntry+0x00000000000000c8)\r\n   ExceptionCode: c0000005 (Access violation)\r\n  ExceptionFlags: 00000000\r\nNumberParameters: 2\r\n   Parameter[0]: 0000000000000000\r\n   Parameter[1]: ffffffffffffffff\r\nAttempt to read from address ffffffffffffffff\r\n\r\nFAULTING_THREAD:  00001838\r\n\r\nPROCESS_NAME:  image00000000`00400000\r\n\r\nREAD_ADDRESS:  ffffffffffffffff \r\n\r\nERROR_CODE: (NTSTATUS) 0xc0000005 - The instruction at 0x%p referenced memory at 0x%p. The memory could not be %s.\r\n\r\nEXCEPTION_CODE_STR:  c0000005\r\n\r\nEXCEPTION_PARAMETER1:  0000000000000000\r\n\r\nEXCEPTION_PARAMETER2:  ffffffffffffffff\r\n\r\nSTACK_TEXT:  \r\n00000000`0065f4c0 00007ff9`f59f74e4     : 00000000`00400080 00000000`000a2a10 00000000`0065f5a0 00000000`00000000 : ntdll!LdrpAllocateTlsEntry+0xc8\r\n00000000`0065f520 00007ff9`f5a8367c     : 00000000`00000001 00000000`00000028 00000000`0044d060 00000000`00400080 : ntdll!LdrpInitializeTls+0xfc\r\n00000000`0065f5a0 00007ff9`f5a24dbb     : 00000000`00000001 00000000`00000000 00000000`00000000 00000000`00000001 : ntdll!LdrpInitializeProcess+0x199c\r\n00000000`0065f9c0 00007ff9`f5a24c43     : 00000000`00000000 00007ff9`f59b0000 00000000`00000000 00000000`00385000 : ntdll!LdrpInitialize+0x15f\r\n00000000`0065fa60 00007ff9`f5a24bee     : 00000000`0065fae0 00000000`00000000 00000000`00000000 00000000`00000000 : ntdll!LdrpInitialize+0x3b\r\n00000000`0065fa90 00000000`00000000     : 00000000`00000000 00000000`00000000 00000000`00000000 00000000`00000000 : ntdll!LdrInitializeThunk+0xe\r\n\r\n\r\nSTACK_COMMAND:  ~0s ; .cxr ; kb\r\n\r\nSYMBOL_NAME:  ntdll!LdrpAllocateTlsEntry+c8\r\n\r\nMODULE_NAME: ntdll\r\n\r\nIMAGE_NAME:  ntdll.dll\r\n\r\nFAILURE_BUCKET_ID:  INVALID_POINTER_READ_c0000005_ntdll.dll!LdrpAllocateTlsEntry\r\n\r\nOS_VERSION:  10.0.19041.1\r\n\r\nBUILDLAB_STR:  vb_release\r\n\r\nOSPLATFORM_TYPE:  x64\r\n\r\nOSNAME:  Windows 10\r\n\r\nIMAGE_VERSION:  10.0.19041.3636\r\n\r\nFAILURE_ID_HASH:  {fde563d4-5794-c66a-9cd3-1abf820d3d24}\r\n\r\nFollowup:     MachineOwner\r\n---------\r\n```\r\n![image](https://github.com/boku7/BokuLoader/assets/44432772/5c1161be-f3f7-4aa7-8b46-17fa6a450c8c)\r\n\r\nA weird thing is it works fine when I use the old version(downloaded about six months ago) of this project, so maybe it is because of some new updated feature?\r\n", "reactions": {"url": "https://api.github.com/repos/boku7/BokuLoader/issues/35/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/boku7/BokuLoader/issues/35/timeline", "performed_via_github_app": null, "state_reason": "completed", "score": 1.0}]}